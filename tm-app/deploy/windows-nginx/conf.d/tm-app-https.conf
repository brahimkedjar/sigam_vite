## HTTPS server for tm-app (enable after you have certificates)

# Optional: redirect HTTP to HTTPS
# server {
#     listen      80;
#     server_name example.com www.example.com;
#     return 301 https://$host$request_uri;
# }

server {
    listen              443 ssl http2;
    server_name         example.com www.example.com;

    # Update certificate paths (PEM format)
    #ssl_certificate     C:/path/to/certs/fullchain.pem;
    #ssl_certificate_key C:/path/to/certs/privkey.pem;

    # Reasonable modern TLS parameters
    include snippets/tls-params.conf;

    # Point this to your built client directory
    root  C:/Users/A/Desktop/sigam_vite/sigam/tm-app/client/dist;
    index index.html;

    access_log  logs/tm-app.access.log;
    error_log   logs/tm-app.error.log;

    include snippets/gzip.conf;
    include snippets/security-headers.conf;

    client_max_body_size 100m;

    location ~* \.(?:js|mjs|css|png|jpg|jpeg|gif|ico|svg|webp|woff|woff2|ttf|otf)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        try_files $uri =404;
    }

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        include     snippets/proxy.conf;
        proxy_pass  http://127.0.0.1:4000;
    }

    location /static/permis_templates/ {
        include     snippets/proxy.conf;
        proxy_pass  http://127.0.0.1:4000;
    }

    location /nginx-health {
        return 200 'ok';
        add_header Content-Type text/plain;
    }
}
